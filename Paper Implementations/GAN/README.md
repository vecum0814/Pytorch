Generative Adversarial Nets with MNIST dataset
=================================================

## GAN은 생성자와 판별자 두 개의 네트워크를 활용한 생성 모델로, 매우 다양한 논문들을 파생시킨 대표적인 생성 모델입니다.


## GAN의 탄생 배경
사진, 음성 파일, 또는 자연어에서의 다양한 심볼들의 확률 분포를 나타낼 수 있는 rich하게 계층적인 모델을 만드는것은 딥러닝의 궁극적인 목표라고 할 수 있습니다. GAN 논문이 발표될 당시에만 하더라도, Discriminative models, 즉 classification 분야에서 개별 선형 유닛들을 gradient와 함께 이용하여 뛰어난 성과를 거뒀습니다만 Deep generative model은 상대적으로 영향력이 덜했습니다. 여기에는 다양한 확률론적 계산을 근사화하는 것이 어렵고 생성하는 측면에서 discriminative model의 개별 선형 유닛들을 활용함으로써 얻을 수 있는 이점을 얻지 못했기 때문입니다. 이러한 단점을 바탕으로, 2014년에 Montreal 대학교에서 새로운 생성 모델을 설계하는 방법일 제안했습니다.

## 생성모델이란?

<img width="768" alt="스크린샷 2022-08-10 오후 9 19 09" src="https://user-images.githubusercontent.com/52812351/183899313-80a57edf-d0a0-4c8a-be71-9e0f54928d20.png">

우선 컴퓨터가 어떻게 존재하지는 않지만 인간의 눈으로 봤을 때 충분히 그럴싸한 이미지를 만들어낼 수 있는지 알아보겠습니다. 확률 분포란 확률 변수가 특정한 값을 가질 확률을 나타내는 함수인데. 이미지 데이터는 다차원 특징 공간의 한 점으로 표현되는데, 이러한 다양한 특징들이 각각의 확률 변수가 되어 다차원 확률 분포를 이룹니다. 이러한 이미지의 분포를 근사하는 모델을 학습하게 된다면 충분히 사실적인 이미지를 표현할 수 있게됩니다. 예를 들어서 사람의 얼굴에는 통계적인 평균치가 존재할 수 있는데, 모델은 이를 수치적으로 표현할 수 있게 됩니다. 생성 모델은 실존하진 않지만 있을법한 이미지를 생성할 수 있는데, 위와 같은 사람의 얼굴 이미지를 근사한 다변수 확률 분포에서 확률이 높은 부분의 데이터를 추출할수록 실제로 존재할법한 사람의 얼굴 이미지를 생성할  수 있게 됩니다.

다시 한번 정리하자면, 원본 이미지 데이터의 분포를 근사하는 모델 G를 만드는 것이 생성 모델의 목표입니다. 모델 G가 잘 작동한다는 의미는 원래 이미지들의 분포를 잘 모델링할 수 있다는 것을 의미하는데, 학습이 잘 되었다면 통계적으로 평균적인 특징을 가지는 데이터를 쉽게 생성할 수 있습니다. 

## GAN의 특징

#### Adversarial Network
> GAN을 처음 제안한 Ian Goodfellow는 GAN을 생성자가 판별자를 속이고, 반면에 판별자는 판별하는 대상이 원본인지 가품인지 판단하는 minimax game에 비유할 수 있다고 설명했습니다. 더욱 더 직관적으로는 경찰(판별자)과 위조지폐범(생성자)사이의 게임에 비유하였는데요, 위조지폐범은 최대한 진짜 같은 화폐를 생성하여 경찰을 속이기 위해 노력하고, 경찰은 진짜 화폐와 가짜 화폐를 완벽히 판별하여 위조지폐범을 검거하는 것을 목표로 합니다. 이러한 경쟁적인 학습이 지속되다 보면 어느 순간 위조지폐범은 진짜와 다를 바 없는 위조 지폐를 만들 수 있게 되고, 경찰이 위조지폐를 구별할 수 있는 확률도 가장 헷갈리는 50%로 수렴하게 되어 경찰은 위조지폐와 실제 화폐를 구분할 수 없는 상태에 이르게 됩니다. 

<img width="694" alt="스크린샷 2022-08-10 오후 9 23 40" src="https://user-images.githubusercontent.com/52812351/183900192-80fde0a7-e996-46bf-a84c-41302541e669.png">

> Adversarial Network에서는 분류 모델과 생성 모델을 학습시키는 과정을 서로 주고받으면서 반복합니다.
##### Discriminitive Model
> > 분류 모델의 학습은 크게 두 가지 단계로 이루어져 있습니다.
> > * 진짜 데이터를 입력해서 네트워크가 해당 데이터를 진짜로 분류하도록 학습하는 과정.
> > * 반대로, 생성 모델에서 생성한 가짜 데이터를 입력해서 해당 데이터를 가짜로 분류하도록 학습하는 과정.
> > 이 과정을 통해 분류 모델은 진짜 데이터를 진짜로, 가짜 데이터를 가짜로 분류할 수 있게 됩니다.

#### Generative Model
> > 그렇다면 생성 모델은 위와 같이 학습된 분류 모델을 속이는 방향으로 학습되어야 합니다.
> > * 생성 모델에서 만들어낸 가짜 데이터를 판별 모델에 입력하고, 가짜 데이터를 진짜라고 분류할 만큼 진짜 데이터와 유사한 데이터를 만들어 내도록 생성 모델을 학습시킵니다.

#### Random Noise
> 이러한 프레임워크는 다양한 방법들을 통해 구현될 수 있는데, GAN 논문에서는 Generative Model에게 random noise를 multilayer perceptron을 거쳐서 넘겨주는 방식으로 sample을 생성하는 방식을 채용했습니다. 아래의 목적 함수에서 z가 noise인데, P_z(z)라는 z의 확률 분포에서 임의로 하나의 sample을 추출하여 이를 Generative Model에 전달하여 가짜 이미지를 생성하고 Discriminative Model로 하여금 해당 이미지의 진위 여부를 판단하게 합니다.
> 
>   <img width="1007" alt="스크린샷 2022-08-10 오후 9 32 02" src="https://user-images.githubusercontent.com/52812351/183901925-59fe179a-b127-452c-9408-c4b80f43552c.png">
